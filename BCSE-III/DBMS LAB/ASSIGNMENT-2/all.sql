Create TABLE EMP(
  	EMP_CODE  	char(5) PRIMARY KEY,
   	EMP_NAME	char(20),
	DEPT_CODE	char(5),
	DESIG_CODE	char(5),
	SEX 		char(1),
    ADDRESS 	char (25),
    CITY 		char (20),
    STATE       char (20),
    PIN    		char (6),
    BASIC 		Number,
    JN_DT		Date				
);

CREATE TABLE DESIGNATION(
    DESIG_CODE char(5) PRIMARY KEY,
    DESIG_DESC char(20)
);

CREATE TABLE DEPARTMENT(
    DEPT_CODE char(5),
    DEPT_NAME char(15)
);

INSERT INTO DESIGNATION (DESIG_CODE, DESIG_DESC) VALUES 
('D001', 'Manager'),
('D002', 'Executive'),
('D003', 'Officer'),
('D004', 'Clerk'),
('D005', 'Helper');

INSERT INTO DEPARTMENT (DEPT_CODE, DEPT_NAME) VALUES 
('DP01', 'Personnel'),
('DP02', 'Production'),
('DP03', 'Purchase'),
('DP04', 'Finance'),
('DP05', 'Research');

INSERT INTO EMP (EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) VALUES 
('E0001', 'John Doe', 'DP01', 'D001', 'M', '123 Street', 'New York', 'NY', '10001', 75000, TO_DATE('2020-06-15', 'YYYY-MM-DD')),
('E0002', 'Jane Smith', 'DP02', 'D002', 'F', '456 Avenue', 'Los Angeles', 'CA', '90001', 60000, TO_DATE('2019-08-21', 'YYYY-MM-DD')),
('E0003', 'Alice Brown', 'DP03', 'D003', 'F', '789 Boulevard', 'Chicago', 'IL', '60601', 50000, TO_DATE('2021-01-10', 'YYYY-MM-DD')),
('E0004', 'Bob White', 'DP04', 'D004', 'M', '101 Lane', 'Houston', 'TX', '77001', 40000, TO_DATE('2018-11-05', 'YYYY-MM-DD')),
('E0005', 'Charlie Black', 'DP05', 'D005', 'M', '202 Street', 'San Francisco', 'CA', '94101', 0, TO_DATE('2022-03-12', 'YYYY-MM-DD'));

INSERT INTO EMP (EMP_CODE, EMP_NAME, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, JN_DT) VALUES 
('E0006', 'David Miller', 'D002', 'M', '303 Park Avenue', 'Boston', 'MA', '02108', TO_DATE('2021-09-25', 'YYYY-MM-DD')),
('E0007', 'Emma Wilson', 'D003', 'F', '505 Sunset Blvd', 'Miami', 'FL', '33101', TO_DATE('2020-12-10', 'YYYY-MM-DD')),
('E0008', 'Liam Johnson', 'D005', 'M', '707 Oak Street', 'Denver', 'CO', '80202', TO_DATE('2019-07-14', 'YYYY-MM-DD

--Q1
SELECT DEPT_CODE,MIN(BASIC),MAX(BASIC),AVG(BASIC) FROM EMP GROUP BY DEPT_CODE;
--Q2
SELECT DEPT_CODE,COUNT(*) FROM EMP WHERE SEX='F' AND DEPT_CODE IS NOT NULL AND SEX IS NOT NULL GROUP BY DEPT_CODE;
--Q3
SELECT CITY, DEPT_CODE, COUNT(*) AS Employee_Count FROM EMP
WHERE CITY IS NOT NULL AND DEPT_CODE IS NOT NULL GROUP BY CITY, DEPT_CODE ORDER BY CITY,DEPT_CODE;
--Q4
SELECT DESIG_CODE, DEPT_CODE, COUNT(*) AS Employee_Count FROM EMP WHERE EXTRACT(YEAR FROM JN_DT)= 2000 GROUP BY DESIG_CODE, DEPT_CODE ORDER BY Employee_Count ASC;
--Q5
SELECT DEPT_CODE, SUM(BASIC) AS Total_Basic FROM EMP WHERE SEX = 'M' AND SEX IS NOT NULL
GROUP BY DEPT_CODE HAVING SUM(BASIC) > 50000 ORDER BY Total_Basic DESC;
--Q6
SELECT EMP_NAME,DESIG_DESC,BASIC FROM EMP E,DESIGNATION D WHERE E.DESIG_CODE=D.DESIG_CODE;
--Q7
SELECT EMP_NAME,DESIG_DESC,DEPT_NAME,BASIC FROM EMP E,DESIGNATION D,DEPARTMENT DE WHERE E.DESIG_CODE=D.DESIG_CODE AND E.DEPT_CODE=DE.DEPT_CODE;
--Q8
SELECT D.DEPT_CODE FROM DEPARTMENT D WHERE NOT EXISTS (SELECT E.DEPT_CODE FROM EMP E WHERE E.DEPT_CODE=D.DEPT_CODE);
--Q9
SELECT D.DEPT_CODE FROM DEPARTMENT D WHERE EXISTS (SELECT E.DEPT_CODE FROM EMP E WHERE E.DEPT_CODE=D.DEPT_CODE);
--Q10
SELECT D.DEPT_CODE FROM DEPARTMENT D WHERE EXISTS (SELECT E.DEPT_CODE FROM EMP E WHERE E.DEPT_CODE=D.DEPT_CODE);
--Q11
SELECT DEPT_CODE FROM EMP WHERE BASIC=(SELECT MAX(BASIC) FROM EMP);
--Q12
SELECT DESIG_DESC FROM EMP E,DESIGNATION D WHERE BASIC=(SELECT MAX(BASIC) FROM EMP) AND E.DESIG_CODE=D.DESIG_CODE ;
--Q13
SELECT E.DEPT_CODE, COUNT(*) FROM EMP E JOIN DESIGNATION D ON E.DESIG_CODE = D.DESIG_CODE WHERE DEPT_CODE IS NOT NULL AND DESIG_DESC = 'Manager' GROUP BY DEPT_CODE;
--Q14
SELECT BASIC FROM EMP WHERE BASIC>=ALL(SELECT DISTINCT BASIC FROM EMP WHERE BASIC IS NOT NULL);
--Q15
SELECT BASIC FROM EMP WHERE BASIC<=ALL(SELECT DISTINCT BASIC FROM EMP WHERE BASIC IS NOT NULL);
--QUESTION 16 
CREATE VIEW AVG_BASIC AS SELECT DEPT_CODE,AVG(BASIC) B FROM EMP GROUP BY DEPT_CODE;
SELECT DEPT_NAME FROM DEPARTMENT WHERE DEPT_CODE IN (SELECT DEPT_CODE FROM AVG_BASIC WHERE  B = (SELECT MAX(B) FROM AVG_BASIC));

--QUESTION 17  
INSERT INTO EMP (EMP_CODE, EMP_NAME, DEPT_CODE, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT) 
VALUES('E009', 'Chris Evans', 'FIN', 'XYZ', 'M', '606 Walnut St', 'Miami', 'FL', '33101', 70000, TO_DATE('2022-02-15', 'YYYY-MM-DD')),('E010', 'Natalie Portman', 'PRL', 'ABC', 'F', '707 Palm St', 'Austin', 'TX', '73301', 55000, TO_DATE('2023-03-10', 'YYYY-MM-DD'));

--QUESTION 18  
DELETE FROM EMP E WHERE E.DESIG_CODE NOT IN (SELECT DESIG_CODE FROM DESIGNATION);

--QUESTION 19  
SELECT EMP_NAME,DEPT_CODE FROM EMP  E WHERE SEX='F' AND BASIC>(SELECT B FROM AVG_BASIC A WHERE A.DEPT_CODE=E.DEPT_CODE);

--QUESTION 20  
SELECT COUNT(*) FROM EMP WHERE SEX='F' AND DESIG_CODE=(SELECT DESIG_CODE FROM DESIGNATION WHERE DESIG_DESC='Manager');